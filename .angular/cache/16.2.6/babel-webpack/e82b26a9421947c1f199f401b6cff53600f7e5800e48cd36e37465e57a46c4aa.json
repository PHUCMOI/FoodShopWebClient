{"ast":null,"code":"import { geometry as g, throttle } from '@progress/kendo-drawing';\nimport { addClass, setDefaultOptions, valueOrDefault, defined, mousewheelDelta, limitValue, deepExtend, elementOffset, isArray, round } from '../common';\nimport { EPSG3857 } from './crs';\nimport { Attribution } from './attribution';\nimport { Navigator } from './navigator';\nimport { ZoomControl } from './zoom';\nimport { Location } from './location';\nimport { Extent } from './extent';\nimport { Tooltip } from './tooltip/tooltip';\nimport { TileLayer } from './layers/tile';\nimport { BubbleLayer } from './layers/bubble';\nimport { ShapeLayer } from './layers/shape';\nimport { MarkerLayer } from './layers/marker';\nimport { removeChildren, setDefaultEvents, proxy, now, on, off, getSupportedFeatures, convertToHtml, renderPos } from './utils';\nimport { Scroller } from './scroller/scroller';\nimport { Observable } from './scroller/observable';\nimport MapService from './../services/map-service';\nimport { CENTER_CHANGE, INIT, ZOOM_CHANGE } from './constants';\nlet math = Math,\n  min = math.min,\n  pow = math.pow,\n  Point = g.Point,\n  MARKER = \"marker\",\n  LOCATION = \"location\",\n  FRICTION = 0.9,\n  FRICTION_MOBILE = 0.93,\n  MOUSEWHEEL = 'wheel',\n  MOUSEWHEEL_THROTTLE = 50,\n  VELOCITY_MULTIPLIER = 5,\n  DEFAULT_ZOOM_RATE = 1;\nconst layersMap = {\n  bubble: BubbleLayer,\n  shape: ShapeLayer,\n  tile: TileLayer,\n  [MARKER]: MarkerLayer\n};\nclass Map extends Observable {\n  constructor(element, options = {}, themeOptions = {}, context = {}) {\n    super();\n    this._init(element, options, themeOptions, context);\n  }\n  destroy() {\n    this.scroller.destroy();\n    if (this._tooltip) {\n      this._tooltip.destroy();\n    }\n    if (this.navigator) {\n      this.navigator.destroy();\n    }\n    if (this.attribution) {\n      this.attribution.destroy();\n    }\n    if (this.zoomControl) {\n      this.zoomControl.destroy();\n    }\n    if (isArray(this.markers)) {\n      this.markers.forEach(markerLayer => {\n        markerLayer.destroy();\n      });\n    } else {\n      this.markers.destroy();\n    }\n    for (let i = 0; i < this.layers.length; i++) {\n      this.layers[i].destroy();\n    }\n    off(this.element, MOUSEWHEEL, this._mousewheelHandler);\n    super.destroy();\n  }\n  _init(element, options = {}, themeOptions = {}, context = {}) {\n    this.support = getSupportedFeatures();\n    this.context = context;\n    this.initObserver(context);\n    this.initServices(context);\n    this._notifyObserver(INIT);\n    this._initOptions(options);\n    this._setEvents(options);\n    this.crs = new EPSG3857();\n    this._initElement(element);\n    this._viewOrigin = this._getOrigin();\n    this._tooltip = this._createTooltip();\n    this._initScroller();\n    this._initMarkers();\n    this._initControls();\n    this._initLayers();\n    this._reset();\n    const mousewheelThrottled = throttle(this._mousewheel.bind(this), MOUSEWHEEL_THROTTLE);\n    this._mousewheelHandler = e => {\n      e.preventDefault();\n      mousewheelThrottled(e);\n    };\n    on(this.element, MOUSEWHEEL, this._mousewheelHandler);\n  }\n  _initOptions(options) {\n    this.options = deepExtend({}, this.options, options);\n  }\n  _initElement(element) {\n    this.element = element;\n    addClass(element, \"k-map\");\n    element.style.position = \"relative\";\n    element.setAttribute(\"data-role\", \"map\");\n    removeChildren(element);\n    const div = convertToHtml(\"<div />\");\n    this.element.appendChild(div);\n  }\n  initServices(context = {}) {\n    this.widgetService = new MapService(this, context);\n  }\n  initObserver(context = {}) {\n    this.observers = [];\n    this.addObserver(context.observer);\n  }\n  addObserver(observer) {\n    if (observer) {\n      this.observers.push(observer);\n    }\n  }\n  removeObserver(observer) {\n    const index = this.observers.indexOf(observer);\n    if (index >= 0) {\n      this.observers.splice(index, 1);\n    }\n  }\n  requiresHandlers(eventNames) {\n    const observers = this.observers;\n    for (let idx = 0; idx < observers.length; idx++) {\n      if (observers[idx].requiresHandlers(eventNames)) {\n        return true;\n      }\n    }\n  }\n  trigger(name, args = {}) {\n    args.sender = this;\n    const observers = this.observers;\n    let isDefaultPrevented = false;\n    for (let idx = 0; idx < observers.length; idx++) {\n      if (observers[idx].trigger(name, args)) {\n        isDefaultPrevented = true;\n      }\n    }\n    if (!isDefaultPrevented) {\n      super.trigger(name, args);\n    }\n    return isDefaultPrevented;\n  }\n  _notifyObserver(name, args = {}) {\n    args.sender = this;\n    const observers = this.observers;\n    let isDefaultPrevented = false;\n    for (let idx = 0; idx < observers.length; idx++) {\n      if (observers[idx].trigger(name, args)) {\n        isDefaultPrevented = true;\n      }\n    }\n    return isDefaultPrevented;\n  }\n  zoom(level) {\n    let options = this.options;\n    let result;\n    if (defined(level)) {\n      const zoomLevel = math.round(limitValue(level, options.minZoom, options.maxZoom));\n      if (options.zoom !== zoomLevel) {\n        options.zoom = zoomLevel;\n        this.widgetService.notify(ZOOM_CHANGE, {\n          zoom: options.zoom\n        });\n        this._reset();\n      }\n      result = this;\n    } else {\n      result = options.zoom;\n    }\n    return result;\n  }\n  center(center) {\n    let result;\n    if (center) {\n      const current = Location.create(center);\n      const previous = Location.create(this.options.center);\n      if (!current.equals(previous)) {\n        this.options.center = current.toArray();\n        this.widgetService.notify(CENTER_CHANGE, {\n          center: this.options.center\n        });\n        this._reset();\n      }\n      result = this;\n    } else {\n      result = Location.create(this.options.center);\n    }\n    return result;\n  }\n  extent(extent) {\n    let result;\n    if (extent) {\n      this._setExtent(extent);\n      result = this;\n    } else {\n      result = this._getExtent();\n    }\n    return result;\n  }\n  setOptions(options = {}) {\n    const element = this.element;\n    this.destroy();\n    removeChildren(element);\n    this._init(element, options, {}, this.context);\n    this._reset();\n  }\n  locationToLayer(location, zoom) {\n    let clamp = !this.options.wraparound;\n    const locationObject = Location.create(location);\n    return this.crs.toPoint(locationObject, this._layerSize(zoom), clamp);\n  }\n  layerToLocation(point, zoom) {\n    let clamp = !this.options.wraparound;\n    const pointObject = Point.create(point);\n    return this.crs.toLocation(pointObject, this._layerSize(zoom), clamp);\n  }\n  locationToView(location) {\n    const locationObject = Location.create(location);\n    let origin = this.locationToLayer(this._viewOrigin);\n    let point = this.locationToLayer(locationObject);\n    return point.translateWith(origin.scale(-1));\n  }\n  viewToLocation(point, zoom) {\n    const origin = this.locationToLayer(this._getOrigin(), zoom);\n    const pointObject = Point.create(point);\n    const pointResult = pointObject.clone().translateWith(origin);\n    return this.layerToLocation(pointResult, zoom);\n  }\n  eventOffset(e) {\n    let x;\n    let y;\n    let offset = elementOffset(this.element);\n    if (e.x && e.x[LOCATION] || e.y && e.y[LOCATION]) {\n      x = e.x[LOCATION] - offset.left;\n      y = e.y[LOCATION] - offset.top;\n    } else {\n      let event = e.originalEvent || e;\n      x = valueOrDefault(event.pageX, event.clientX) - offset.left;\n      y = valueOrDefault(event.pageY, event.clientY) - offset.top;\n    }\n    const point = new g.Point(x, y);\n    return point;\n  }\n  eventToView(e) {\n    let cursor = this.eventOffset(e);\n    return this.locationToView(this.viewToLocation(cursor));\n  }\n  eventToLayer(e) {\n    return this.locationToLayer(this.eventToLocation(e));\n  }\n  eventToLocation(e) {\n    let cursor = this.eventOffset(e);\n    return this.viewToLocation(cursor);\n  }\n  viewSize() {\n    let element = this.element;\n    let scale = this._layerSize();\n    let width = element.clientWidth;\n    if (!this.options.wraparound) {\n      width = min(scale, width);\n    }\n    return {\n      width: width,\n      height: min(scale, element.clientHeight)\n    };\n  }\n  exportVisual() {\n    this._reset();\n    return false;\n  }\n  hideTooltip() {\n    if (this._tooltip) {\n      this._tooltip.hide();\n    }\n  }\n  _setOrigin(origin, zoom) {\n    let size = this.viewSize(),\n      topLeft;\n    const originLocation = this._origin = Location.create(origin);\n    topLeft = this.locationToLayer(originLocation, zoom);\n    topLeft.x += size.width / 2;\n    topLeft.y += size.height / 2;\n    this.options.center = this.layerToLocation(topLeft, zoom).toArray();\n    this.widgetService.notify(CENTER_CHANGE, {\n      center: this.options.center\n    });\n    return this;\n  }\n  _getOrigin(invalidate) {\n    let size = this.viewSize(),\n      topLeft;\n    if (invalidate || !this._origin) {\n      topLeft = this.locationToLayer(this.center());\n      topLeft.x -= size.width / 2;\n      topLeft.y -= size.height / 2;\n      this._origin = this.layerToLocation(topLeft);\n    }\n    return this._origin;\n  }\n  _setExtent(newExtent) {\n    let raw = Extent.create(newExtent);\n    let se = raw.se.clone();\n    if (this.options.wraparound && se.lng < 0 && newExtent.nw.lng > 0) {\n      se.lng = 180 + (180 + se.lng);\n    }\n    const extent = new Extent(raw.nw, se);\n    this.center(extent.center());\n    let width = this.element.clientWidth;\n    let height = this.element.clientHeight;\n    let zoom;\n    for (zoom = this.options.maxZoom; zoom >= this.options.minZoom; zoom--) {\n      let topLeft = this.locationToLayer(extent.nw, zoom);\n      let bottomRight = this.locationToLayer(extent.se, zoom);\n      let layerWidth = math.abs(bottomRight.x - topLeft.x);\n      let layerHeight = math.abs(bottomRight.y - topLeft.y);\n      if (layerWidth <= width && layerHeight <= height) {\n        break;\n      }\n    }\n    this.zoom(zoom);\n  }\n  _getExtent() {\n    let nw = this._getOrigin();\n    let bottomRight = this.locationToLayer(nw);\n    let size = this.viewSize();\n    bottomRight.x += size.width;\n    bottomRight.y += size.height;\n    let se = this.layerToLocation(bottomRight);\n    return new Extent(nw, se);\n  }\n  _zoomAround(pivot, level) {\n    this._setOrigin(this.layerToLocation(pivot, level), level);\n    this.zoom(level);\n  }\n  _initControls() {\n    let controls = this.options.controls;\n    if (controls.attribution) {\n      this._createAttribution(controls.attribution);\n    }\n    if (!this.support.mobileOS) {\n      if (controls.navigator) {\n        this._createNavigator(controls.navigator);\n      }\n      if (controls.zoom) {\n        this._createZoomControl(controls.zoom);\n      }\n    }\n  }\n  _createControlElement(options, defaultPosition) {\n    let pos = options.position || defaultPosition;\n    let posSelector = '.' + renderPos(pos).replace(' ', '.');\n    let wrap = this.element.querySelector('.k-map-controls' + posSelector) || [];\n    if (wrap.length === 0) {\n      let div = document.createElement(\"div\");\n      addClass(div, 'k-map-controls ' + renderPos(pos));\n      wrap = div;\n      this.element.appendChild(wrap);\n    }\n    let div = document.createElement(\"div\");\n    wrap.appendChild(div);\n    return div;\n  }\n  _createAttribution(options) {\n    let element = this._createControlElement(options, 'bottomRight');\n    this.attribution = new Attribution(element, options);\n  }\n  _createNavigator(options) {\n    let element = this._createControlElement(options, 'topLeft');\n    let navigator = this.navigator = new Navigator(element, deepExtend({}, options, {\n      icons: this.options.icons\n    }));\n    this._navigatorPan = this._navigatorPan.bind(this);\n    navigator.bind('pan', this._navigatorPan);\n    this._navigatorCenter = this._navigatorCenter.bind(this);\n    navigator.bind('center', this._navigatorCenter);\n  }\n  _navigatorPan(e) {\n    let scroller = this.scroller;\n    let x = scroller.scrollLeft + e.x;\n    let y = scroller.scrollTop - e.y;\n    let bounds = this._virtualSize;\n    let width = this.element.clientWidth;\n    let height = this.element.clientHeight;\n\n    // TODO: Move limits to scroller\n    x = limitValue(x, bounds.x.min, bounds.x.max - width);\n    y = limitValue(y, bounds.y.min, bounds.y.max - height);\n    this.scroller.one('scroll', proxy(this._scrollEnd, this));\n    this.scroller.scrollTo(-x, -y);\n  }\n  _navigatorCenter() {\n    this.center(this.options.center);\n  }\n  _createZoomControl(options) {\n    let element = this._createControlElement(options, 'topLeft');\n    let zoomControl = this.zoomControl = new ZoomControl(element, options, this.options.icons);\n    this._zoomControlChange = this._zoomControlChange.bind(this);\n    zoomControl.bind('change', this._zoomControlChange);\n  }\n  _zoomControlChange(e) {\n    if (!this.trigger('zoomStart', {\n      originalEvent: e\n    })) {\n      this.zoom(this.zoom() + e.delta);\n      this.trigger('zoomEnd', {\n        originalEvent: e\n      });\n    }\n  }\n  _initScroller() {\n    let friction = this.support.mobileOS ? FRICTION_MOBILE : FRICTION;\n    let zoomable = this.options.zoomable !== false;\n    let scroller = this.scroller = new Scroller(this.element.children[0], {\n      friction: friction,\n      velocityMultiplier: VELOCITY_MULTIPLIER,\n      zoom: zoomable,\n      mousewheelScrolling: false,\n      supportDoubleTap: true\n    });\n    scroller.bind('scroll', proxy(this._scroll, this));\n    scroller.bind('scrollEnd', proxy(this._scrollEnd, this));\n    scroller.userEvents.bind('gesturestart', proxy(this._scaleStart, this));\n    scroller.userEvents.bind('gestureend', proxy(this._scale, this));\n    scroller.userEvents.bind('doubleTap', proxy(this._doubleTap, this));\n    scroller.userEvents.bind('tap', proxy(this._tap, this));\n    this.scrollElement = scroller.scrollElement;\n  }\n  _initLayers() {\n    let defs = this.options.layers,\n      layers = this.layers = [];\n    for (let i = 0; i < defs.length; i++) {\n      let options = defs[i];\n      const layer = this._createLayer(options);\n      layers.push(layer);\n    }\n  }\n  _createLayer(options) {\n    let type = options.type || 'shape';\n    let layerDefaults = this.options.layerDefaults[type];\n    let layerOptions = type === MARKER ? deepExtend({}, this.options.markerDefaults, options, {\n      icons: this.options.icons\n    }) : deepExtend({}, layerDefaults, options);\n    let layerConstructor = layersMap[type];\n    let layer = new layerConstructor(this, layerOptions);\n    if (type === MARKER) {\n      this.markers = layer;\n    }\n    return layer;\n  }\n  _createTooltip() {\n    return new Tooltip(this.widgetService, this.options.tooltip);\n  }\n\n  /* eslint-disable arrow-body-style */\n  _initMarkers() {\n    const markerLayers = (this.options.layers || []).filter(x => {\n      return x && x.type === MARKER;\n    });\n    if (markerLayers.length > 0) {\n      // render the markers from options.layers\n      // instead of options.markers\n      return;\n    }\n    this.markers = new MarkerLayer(this, deepExtend({}, this.options.markerDefaults, {\n      icons: this.options.icons\n    }));\n    this.markers.add(this.options.markers);\n  }\n  /* eslint-enable arrow-body-style */\n\n  _scroll(e) {\n    let origin = this.locationToLayer(this._viewOrigin).round();\n    let movable = e.sender.movable;\n    let offset = new g.Point(movable.x, movable.y).scale(-1).scale(1 / movable.scale);\n    origin.x += offset.x;\n    origin.y += offset.y;\n    this._scrollOffset = offset;\n    this._tooltip.offset = offset;\n    this.hideTooltip();\n    this._setOrigin(this.layerToLocation(origin));\n    this.trigger('pan', {\n      originalEvent: e,\n      origin: this._getOrigin(),\n      center: this.center()\n    });\n  }\n  _scrollEnd(e) {\n    if (!this._scrollOffset || !this._panComplete()) {\n      return;\n    }\n    this._scrollOffset = null;\n    this._panEndTimestamp = now();\n    this.trigger('panEnd', {\n      originalEvent: e,\n      origin: this._getOrigin(),\n      center: this.center()\n    });\n  }\n  _panComplete() {\n    return now() - (this._panEndTimestamp || 0) > 50;\n  }\n  _scaleStart(e) {\n    if (this.trigger('zoomStart', {\n      originalEvent: e\n    })) {\n      let touch = e.touches[1];\n      if (touch) {\n        touch.cancel();\n      }\n    }\n  }\n  _scale(e) {\n    let scale = this.scroller.movable.scale;\n    let zoom = this._scaleToZoom(scale);\n    let gestureCenter = new g.Point(e.center.x, e.center.y);\n    let centerLocation = this.viewToLocation(gestureCenter, zoom);\n    let centerPoint = this.locationToLayer(centerLocation, zoom);\n    let originPoint = centerPoint.translate(-gestureCenter.x, -gestureCenter.y);\n    this._zoomAround(originPoint, zoom);\n    this.trigger('zoomEnd', {\n      originalEvent: e\n    });\n  }\n  _scaleToZoom(scaleDelta) {\n    let scale = this._layerSize() * scaleDelta;\n    let tiles = scale / this.options.minSize;\n    let zoom = math.log(tiles) / math.log(2);\n    return math.round(zoom);\n  }\n  _reset() {\n    if (this.attribution) {\n      this.attribution.filter(this.center(), this.zoom());\n    }\n    this._viewOrigin = this._getOrigin(true);\n    this._resetScroller();\n    this.hideTooltip();\n    this.trigger('beforeReset');\n    this.trigger('reset');\n  }\n  _resetScroller() {\n    let scroller = this.scroller;\n    let x = scroller.dimensions.x;\n    let y = scroller.dimensions.y;\n    let scale = this._layerSize();\n    let nw = this.extent().nw;\n    let topLeft = this.locationToLayer(nw).round();\n    scroller.movable.round = true;\n    scroller.reset();\n    scroller.userEvents.cancel();\n    let zoom = this.zoom();\n    scroller.dimensions.forcedMinScale = pow(2, this.options.minZoom - zoom);\n    scroller.dimensions.maxScale = pow(2, this.options.maxZoom - zoom);\n    let xBounds = {\n      min: -topLeft.x,\n      max: scale - topLeft.x\n    };\n    let yBounds = {\n      min: -topLeft.y,\n      max: scale - topLeft.y\n    };\n    if (this.options.wraparound) {\n      xBounds.max = 20 * scale;\n      xBounds.min = -xBounds.max;\n    }\n    if (this.options.pannable === false) {\n      let viewSize = this.viewSize();\n      xBounds.min = yBounds.min = 0;\n      xBounds.max = viewSize.width;\n      yBounds.max = viewSize.height;\n    }\n    x.makeVirtual();\n    y.makeVirtual();\n    x.virtualSize(xBounds.min, xBounds.max);\n    y.virtualSize(yBounds.min, yBounds.max);\n    this._virtualSize = {\n      x: xBounds,\n      y: yBounds\n    };\n  }\n\n  // kept for API compatibility, not used\n  _renderLayers() {}\n  _layerSize(zoom) {\n    const newZoom = valueOrDefault(zoom, this.options.zoom);\n    return this.options.minSize * pow(2, newZoom);\n  }\n  _tap(e) {\n    if (!this._panComplete()) {\n      return;\n    }\n    let cursor = this.eventOffset(e);\n    this.hideTooltip();\n    this.trigger('click', {\n      originalEvent: e,\n      location: this.viewToLocation(cursor)\n    });\n  }\n  _doubleTap(e) {\n    let options = this.options;\n    if (options.zoomable !== false) {\n      if (!this.trigger('zoomStart', {\n        originalEvent: e\n      })) {\n        let toZoom = this.zoom() + DEFAULT_ZOOM_RATE;\n        let cursor = this.eventOffset(e);\n        let location = this.viewToLocation(cursor);\n        let postZoom = this.locationToLayer(location, toZoom);\n        let origin = postZoom.translate(-cursor.x, -cursor.y);\n        this._zoomAround(origin, toZoom);\n        this.trigger('zoomEnd', {\n          originalEvent: e\n        });\n      }\n    }\n  }\n  _mousewheel(e) {\n    let delta = mousewheelDelta(e) > 0 ? -1 : 1;\n    let options = this.options;\n    let fromZoom = this.zoom();\n    let toZoom = limitValue(fromZoom + delta, options.minZoom, options.maxZoom);\n    if (options.zoomable !== false && toZoom !== fromZoom) {\n      if (!this.trigger('zoomStart', {\n        originalEvent: e\n      })) {\n        let cursor = this.eventOffset(e);\n        let location = this.viewToLocation(cursor);\n        let postZoom = this.locationToLayer(location, toZoom);\n        let origin = postZoom.translate(-cursor.x, -cursor.y);\n        this._zoomAround(origin, toZoom);\n        this.trigger('zoomEnd', {\n          originalEvent: e\n        });\n      }\n    }\n  }\n  _toDocumentCoordinates(point) {\n    const offset = elementOffset(this.element);\n    return {\n      left: round(point.x + offset.left),\n      top: round(point.y + offset.top)\n    };\n  }\n}\nsetDefaultOptions(Map, {\n  name: 'Map',\n  controls: {\n    attribution: true,\n    navigator: {\n      panStep: 100\n    },\n    zoom: true\n  },\n  layers: [],\n  layerDefaults: {\n    shape: {\n      style: {\n        fill: {\n          color: '#fff'\n        },\n        stroke: {\n          color: '#aaa',\n          width: 0.5\n        }\n      }\n    },\n    bubble: {\n      style: {\n        fill: {\n          color: '#fff',\n          opacity: 0.5\n        },\n        stroke: {\n          color: '#aaa',\n          width: 0.5\n        }\n      }\n    },\n    marker: {\n      shape: 'pinTarget',\n      tooltip: {\n        position: 'top'\n      }\n    }\n  },\n  center: [0, 0],\n  icons: {\n    type: \"font\",\n    svgIcons: {}\n  },\n  zoom: 3,\n  minSize: 256,\n  minZoom: 1,\n  maxZoom: 19,\n  markers: [],\n  markerDefaults: {\n    shape: 'pinTarget',\n    tooltip: {\n      position: 'top'\n    }\n  },\n  wraparound: true,\n  // If set to true, GeoJSON layer \"Point\" features will be rendered as markers.\n  // Otherwise, the points will be rendered as circles.\n  // Defaults to `true` for KUI/jQuery, `false` everywhere else.\n  renderPointsAsMarkers: false\n});\nsetDefaultEvents(Map, ['beforeReset', 'click', 'markerActivate', 'markerClick', 'markerCreated',\n// Events for implementing custom tooltips.\n'markerMouseEnter', 'markerMouseLeave', 'pan', 'panEnd', 'reset', 'shapeClick', 'shapeCreated', 'shapeFeatureCreated', 'shapeMouseEnter', 'shapeMouseLeave', 'zoomEnd', 'zoomStart']);\nexport default Map;","map":{"version":3,"names":["geometry","g","throttle","addClass","setDefaultOptions","valueOrDefault","defined","mousewheelDelta","limitValue","deepExtend","elementOffset","isArray","round","EPSG3857","Attribution","Navigator","ZoomControl","Location","Extent","Tooltip","TileLayer","BubbleLayer","ShapeLayer","MarkerLayer","removeChildren","setDefaultEvents","proxy","now","on","off","getSupportedFeatures","convertToHtml","renderPos","Scroller","Observable","MapService","CENTER_CHANGE","INIT","ZOOM_CHANGE","math","Math","min","pow","Point","MARKER","LOCATION","FRICTION","FRICTION_MOBILE","MOUSEWHEEL","MOUSEWHEEL_THROTTLE","VELOCITY_MULTIPLIER","DEFAULT_ZOOM_RATE","layersMap","bubble","shape","tile","Map","constructor","element","options","themeOptions","context","_init","destroy","scroller","_tooltip","navigator","attribution","zoomControl","markers","forEach","markerLayer","i","layers","length","_mousewheelHandler","support","initObserver","initServices","_notifyObserver","_initOptions","_setEvents","crs","_initElement","_viewOrigin","_getOrigin","_createTooltip","_initScroller","_initMarkers","_initControls","_initLayers","_reset","mousewheelThrottled","_mousewheel","bind","e","preventDefault","style","position","setAttribute","div","appendChild","widgetService","observers","addObserver","observer","push","removeObserver","index","indexOf","splice","requiresHandlers","eventNames","idx","trigger","name","args","sender","isDefaultPrevented","zoom","level","result","zoomLevel","minZoom","maxZoom","notify","center","current","create","previous","equals","toArray","extent","_setExtent","_getExtent","setOptions","locationToLayer","location","clamp","wraparound","locationObject","toPoint","_layerSize","layerToLocation","point","pointObject","toLocation","locationToView","origin","translateWith","scale","viewToLocation","pointResult","clone","eventOffset","x","y","offset","left","top","event","originalEvent","pageX","clientX","pageY","clientY","eventToView","cursor","eventToLayer","eventToLocation","viewSize","width","clientWidth","height","clientHeight","exportVisual","hideTooltip","hide","_setOrigin","size","topLeft","originLocation","_origin","invalidate","newExtent","raw","se","lng","nw","bottomRight","layerWidth","abs","layerHeight","_zoomAround","pivot","controls","_createAttribution","mobileOS","_createNavigator","_createZoomControl","_createControlElement","defaultPosition","pos","posSelector","replace","wrap","querySelector","document","createElement","icons","_navigatorPan","_navigatorCenter","scrollLeft","scrollTop","bounds","_virtualSize","max","one","_scrollEnd","scrollTo","_zoomControlChange","delta","friction","zoomable","children","velocityMultiplier","mousewheelScrolling","supportDoubleTap","_scroll","userEvents","_scaleStart","_scale","_doubleTap","_tap","scrollElement","defs","layer","_createLayer","type","layerDefaults","layerOptions","markerDefaults","layerConstructor","tooltip","markerLayers","filter","add","movable","_scrollOffset","_panComplete","_panEndTimestamp","touch","touches","cancel","_scaleToZoom","gestureCenter","centerLocation","centerPoint","originPoint","translate","scaleDelta","tiles","minSize","log","_resetScroller","dimensions","reset","forcedMinScale","maxScale","xBounds","yBounds","pannable","makeVirtual","virtualSize","_renderLayers","newZoom","toZoom","postZoom","fromZoom","_toDocumentCoordinates","panStep","fill","color","stroke","opacity","marker","svgIcons","renderPointsAsMarkers"],"sources":["C:/Internship/FoodShopUI/node_modules/@progress/kendo-charts/dist/es2015/map/map.js"],"sourcesContent":["import {\n    geometry as g,\n    throttle\n} from '@progress/kendo-drawing';\n\nimport {\n    addClass,\n    setDefaultOptions,\n    valueOrDefault,\n    defined,\n    mousewheelDelta,\n    limitValue,\n    deepExtend,\n    elementOffset,\n    isArray,\n    round\n} from '../common';\n\nimport {\n    EPSG3857\n} from './crs';\n\nimport {\n    Attribution\n} from './attribution';\n\nimport {\n    Navigator\n} from './navigator';\n\nimport {\n    ZoomControl\n} from './zoom';\n\nimport {\n    Location\n} from './location';\n\nimport {\n    Extent\n} from './extent';\n\nimport { Tooltip } from './tooltip/tooltip';\n\nimport {\n    TileLayer\n} from './layers/tile';\n\nimport {\n    BubbleLayer\n} from './layers/bubble';\n\nimport {\n    ShapeLayer\n} from './layers/shape';\n\nimport {\n    MarkerLayer\n} from './layers/marker';\n\nimport {\n    removeChildren,\n    setDefaultEvents,\n    proxy,\n    now,\n    on,\n    off,\n    getSupportedFeatures,\n    convertToHtml,\n    renderPos\n} from './utils';\n\nimport {\n    Scroller\n} from './scroller/scroller';\n\nimport {\n    Observable\n} from './scroller/observable';\n\nimport MapService from './../services/map-service';\n\nimport { CENTER_CHANGE, INIT, ZOOM_CHANGE } from './constants';\n\nlet math = Math,\n    min = math.min,\n    pow = math.pow,\n    Point = g.Point,\n    MARKER = \"marker\",\n    LOCATION = \"location\",\n    FRICTION = 0.9,\n    FRICTION_MOBILE = 0.93,\n    MOUSEWHEEL = 'wheel',\n    MOUSEWHEEL_THROTTLE = 50,\n    VELOCITY_MULTIPLIER = 5,\n    DEFAULT_ZOOM_RATE = 1;\n\nconst layersMap = {\n    bubble: BubbleLayer,\n    shape: ShapeLayer,\n    tile: TileLayer,\n    [MARKER]: MarkerLayer\n};\n\nclass Map extends Observable {\n    constructor(element, options = {}, themeOptions = {}, context = {}) {\n        super();\n\n        this._init(element, options, themeOptions, context);\n    }\n\n    destroy() {\n        this.scroller.destroy();\n\n        if (this._tooltip) {\n            this._tooltip.destroy();\n        }\n\n        if (this.navigator) {\n            this.navigator.destroy();\n        }\n        if (this.attribution) {\n            this.attribution.destroy();\n        }\n        if (this.zoomControl) {\n            this.zoomControl.destroy();\n        }\n\n        if (isArray(this.markers)) {\n            this.markers.forEach(markerLayer => {\n                markerLayer.destroy();\n            });\n        } else {\n            this.markers.destroy();\n        }\n\n        for (let i = 0; i < this.layers.length; i++) {\n            this.layers[i].destroy();\n        }\n\n        off(this.element, MOUSEWHEEL, this._mousewheelHandler);\n\n        super.destroy();\n    }\n\n    _init(element, options = {}, themeOptions = {}, context = {}) {\n        this.support = getSupportedFeatures();\n        this.context = context;\n\n        this.initObserver(context);\n        this.initServices(context);\n        this._notifyObserver(INIT);\n\n        this._initOptions(options);\n        this._setEvents(options);\n        this.crs = new EPSG3857();\n\n        this._initElement(element);\n\n        this._viewOrigin = this._getOrigin();\n\n        this._tooltip = this._createTooltip();\n        this._initScroller();\n        this._initMarkers();\n        this._initControls();\n        this._initLayers();\n        this._reset();\n\n        const mousewheelThrottled = throttle(this._mousewheel.bind(this), MOUSEWHEEL_THROTTLE);\n        this._mousewheelHandler = (e) => {\n            e.preventDefault();\n            mousewheelThrottled(e);\n        };\n        on(this.element, MOUSEWHEEL, this._mousewheelHandler);\n    }\n\n    _initOptions(options) {\n        this.options = deepExtend({}, this.options, options);\n    }\n\n    _initElement(element) {\n        this.element = element;\n\n        addClass(element, \"k-map\");\n        element.style.position = \"relative\";\n        element.setAttribute(\"data-role\", \"map\");\n        removeChildren(element);\n\n        const div = convertToHtml(\"<div />\");\n        this.element.appendChild(div);\n    }\n\n    initServices(context = {}) {\n        this.widgetService = new MapService(this, context);\n    }\n\n    initObserver(context = {}) {\n        this.observers = [];\n        this.addObserver(context.observer);\n    }\n\n    addObserver(observer) {\n        if (observer) {\n            this.observers.push(observer);\n        }\n    }\n\n    removeObserver(observer) {\n        const index = this.observers.indexOf(observer);\n\n        if (index >= 0) {\n            this.observers.splice(index, 1);\n        }\n    }\n\n    requiresHandlers(eventNames) {\n        const observers = this.observers;\n\n        for (let idx = 0; idx < observers.length; idx++) {\n            if (observers[idx].requiresHandlers(eventNames)) {\n                return true;\n            }\n        }\n    }\n\n    trigger(name, args = {}) {\n        args.sender = this;\n\n        const observers = this.observers;\n        let isDefaultPrevented = false;\n\n        for (let idx = 0; idx < observers.length; idx++) {\n            if (observers[idx].trigger(name, args)) {\n                isDefaultPrevented = true;\n            }\n        }\n\n        if (!isDefaultPrevented) {\n            super.trigger(name, args);\n        }\n\n        return isDefaultPrevented;\n    }\n\n    _notifyObserver(name, args = {}) {\n        args.sender = this;\n\n        const observers = this.observers;\n        let isDefaultPrevented = false;\n\n        for (let idx = 0; idx < observers.length; idx++) {\n            if (observers[idx].trigger(name, args)) {\n                isDefaultPrevented = true;\n            }\n        }\n\n        return isDefaultPrevented;\n    }\n\n    zoom(level) {\n        let options = this.options;\n        let result;\n\n        if (defined(level)) {\n            const zoomLevel = math.round(limitValue(level, options.minZoom, options.maxZoom));\n\n            if (options.zoom !== zoomLevel) {\n                options.zoom = zoomLevel;\n                this.widgetService.notify(ZOOM_CHANGE, { zoom: options.zoom });\n\n                this._reset();\n            }\n            result = this;\n        } else {\n            result = options.zoom;\n        }\n\n        return result;\n    }\n\n    center(center) {\n        let result;\n\n        if (center) {\n            const current = Location.create(center);\n            const previous = Location.create(this.options.center);\n            if (!current.equals(previous)) {\n                this.options.center = current.toArray();\n                this.widgetService.notify(CENTER_CHANGE, { center: this.options.center });\n                this._reset();\n            }\n\n            result = this;\n        } else {\n            result = Location.create(this.options.center);\n        }\n\n        return result;\n    }\n\n    extent(extent) {\n        let result;\n\n        if (extent) {\n            this._setExtent(extent);\n            result = this;\n        } else {\n            result = this._getExtent();\n        }\n\n        return result;\n    }\n\n    setOptions(options = {}) {\n        const element = this.element;\n\n        this.destroy();\n        removeChildren(element);\n        this._init(element, options, {}, this.context);\n\n        this._reset();\n    }\n\n    locationToLayer(location, zoom) {\n        let clamp = !this.options.wraparound;\n        const locationObject = Location.create(location);\n\n        return this.crs.toPoint(locationObject, this._layerSize(zoom), clamp);\n    }\n\n    layerToLocation(point, zoom) {\n        let clamp = !this.options.wraparound;\n        const pointObject = Point.create(point);\n\n        return this.crs.toLocation(pointObject, this._layerSize(zoom), clamp);\n    }\n\n    locationToView(location) {\n        const locationObject = Location.create(location);\n        let origin = this.locationToLayer(this._viewOrigin);\n        let point = this.locationToLayer(locationObject);\n\n        return point.translateWith(origin.scale(-1));\n    }\n\n    viewToLocation(point, zoom) {\n        const origin = this.locationToLayer(this._getOrigin(), zoom);\n        const pointObject = Point.create(point);\n        const pointResult = pointObject.clone().translateWith(origin);\n\n        return this.layerToLocation(pointResult, zoom);\n    }\n\n    eventOffset(e) {\n        let x;\n        let y;\n        let offset = elementOffset(this.element);\n\n        if ((e.x && e.x[LOCATION]) || (e.y && e.y[LOCATION])) {\n            x = e.x[LOCATION] - offset.left;\n            y = e.y[LOCATION] - offset.top;\n        } else {\n            let event = e.originalEvent || e;\n            x = valueOrDefault(event.pageX, event.clientX) - offset.left;\n            y = valueOrDefault(event.pageY, event.clientY) - offset.top;\n        }\n\n        const point = new g.Point(x, y);\n\n        return point;\n    }\n\n    eventToView(e) {\n        let cursor = this.eventOffset(e);\n        return this.locationToView(this.viewToLocation(cursor));\n    }\n\n    eventToLayer(e) {\n        return this.locationToLayer(this.eventToLocation(e));\n    }\n\n    eventToLocation(e) {\n        let cursor = this.eventOffset(e);\n        return this.viewToLocation(cursor);\n    }\n\n    viewSize() {\n        let element = this.element;\n        let scale = this._layerSize();\n        let width = element.clientWidth;\n\n        if (!this.options.wraparound) {\n            width = min(scale, width);\n        }\n\n        return {\n            width: width,\n            height: min(scale, element.clientHeight)\n        };\n    }\n\n    exportVisual() {\n        this._reset();\n        return false;\n    }\n\n    hideTooltip() {\n        if (this._tooltip) {\n            this._tooltip.hide();\n        }\n    }\n\n    _setOrigin(origin, zoom) {\n        let size = this.viewSize(),\n            topLeft;\n\n        const originLocation = this._origin = Location.create(origin);\n        topLeft = this.locationToLayer(originLocation, zoom);\n        topLeft.x += size.width / 2;\n        topLeft.y += size.height / 2;\n        this.options.center = this.layerToLocation(topLeft, zoom).toArray();\n        this.widgetService.notify(CENTER_CHANGE, { center: this.options.center });\n\n        return this;\n    }\n\n    _getOrigin(invalidate) {\n        let size = this.viewSize(),\n            topLeft;\n\n        if (invalidate || !this._origin) {\n            topLeft = this.locationToLayer(this.center());\n            topLeft.x -= size.width / 2;\n            topLeft.y -= size.height / 2;\n            this._origin = this.layerToLocation(topLeft);\n        }\n\n        return this._origin;\n    }\n\n    _setExtent(newExtent) {\n        let raw = Extent.create(newExtent);\n        let se = raw.se.clone();\n\n        if (this.options.wraparound && se.lng < 0 && newExtent.nw.lng > 0) {\n            se.lng = 180 + (180 + se.lng);\n        }\n\n        const extent = new Extent(raw.nw, se);\n        this.center(extent.center());\n        let width = this.element.clientWidth;\n        let height = this.element.clientHeight;\n        let zoom;\n\n        for (zoom = this.options.maxZoom; zoom >= this.options.minZoom; zoom--) {\n            let topLeft = this.locationToLayer(extent.nw, zoom);\n            let bottomRight = this.locationToLayer(extent.se, zoom);\n            let layerWidth = math.abs(bottomRight.x - topLeft.x);\n            let layerHeight = math.abs(bottomRight.y - topLeft.y);\n\n            if (layerWidth <= width && layerHeight <= height) {\n                break;\n            }\n        }\n\n        this.zoom(zoom);\n    }\n\n    _getExtent() {\n        let nw = this._getOrigin();\n        let bottomRight = this.locationToLayer(nw);\n        let size = this.viewSize();\n\n        bottomRight.x += size.width;\n        bottomRight.y += size.height;\n\n        let se = this.layerToLocation(bottomRight);\n\n        return new Extent(nw, se);\n    }\n\n    _zoomAround(pivot, level) {\n        this._setOrigin(this.layerToLocation(pivot, level), level);\n        this.zoom(level);\n    }\n\n    _initControls() {\n        let controls = this.options.controls;\n        if (controls.attribution) {\n            this._createAttribution(controls.attribution);\n        }\n\n        if (!this.support.mobileOS) {\n            if (controls.navigator) {\n                this._createNavigator(controls.navigator);\n            }\n\n            if (controls.zoom) {\n                this._createZoomControl(controls.zoom);\n            }\n        }\n    }\n\n    _createControlElement(options, defaultPosition) {\n        let pos = options.position || defaultPosition;\n        let posSelector = '.' + renderPos(pos).replace(' ', '.');\n        let wrap = this.element.querySelector('.k-map-controls' + posSelector) || [];\n\n        if (wrap.length === 0) {\n            let div = document.createElement(\"div\");\n            addClass(div, 'k-map-controls ' + renderPos(pos));\n            wrap = div;\n            this.element.appendChild(wrap);\n        }\n\n        let div = document.createElement(\"div\");\n\n        wrap.appendChild(div);\n\n        return div;\n    }\n\n    _createAttribution(options) {\n        let element = this._createControlElement(options, 'bottomRight');\n        this.attribution = new Attribution(element, options);\n    }\n\n    _createNavigator(options) {\n        let element = this._createControlElement(options, 'topLeft');\n        let navigator = this.navigator = new Navigator(element, deepExtend({}, options, { icons: this.options.icons }));\n\n        this._navigatorPan = this._navigatorPan.bind(this);\n        navigator.bind('pan', this._navigatorPan);\n\n        this._navigatorCenter = this._navigatorCenter.bind(this);\n        navigator.bind('center', this._navigatorCenter);\n    }\n\n    _navigatorPan(e) {\n        let scroller = this.scroller;\n        let x = scroller.scrollLeft + e.x;\n        let y = scroller.scrollTop - e.y;\n        let bounds = this._virtualSize;\n        let width = this.element.clientWidth;\n        let height = this.element.clientHeight;\n\n        // TODO: Move limits to scroller\n        x = limitValue(x, bounds.x.min, bounds.x.max - width);\n        y = limitValue(y, bounds.y.min, bounds.y.max - height);\n\n        this.scroller.one('scroll', proxy(this._scrollEnd, this));\n\n        this.scroller.scrollTo(-x, -y);\n    }\n\n    _navigatorCenter() {\n        this.center(this.options.center);\n    }\n\n    _createZoomControl(options) {\n        let element = this._createControlElement(options, 'topLeft');\n        let zoomControl = this.zoomControl = new ZoomControl(element, options, this.options.icons);\n\n        this._zoomControlChange = this._zoomControlChange.bind(this);\n        zoomControl.bind('change', this._zoomControlChange);\n    }\n\n    _zoomControlChange(e) {\n        if (!this.trigger('zoomStart', { originalEvent: e })) {\n            this.zoom(this.zoom() + e.delta);\n\n            this.trigger('zoomEnd', {\n                originalEvent: e\n            });\n        }\n    }\n\n    _initScroller() {\n        let friction = this.support.mobileOS ? FRICTION_MOBILE : FRICTION;\n        let zoomable = this.options.zoomable !== false;\n        let scroller = this.scroller = new Scroller(this.element.children[0], {\n            friction: friction,\n            velocityMultiplier: VELOCITY_MULTIPLIER,\n            zoom: zoomable,\n            mousewheelScrolling: false,\n            supportDoubleTap: true\n        });\n\n        scroller.bind('scroll', proxy(this._scroll, this));\n        scroller.bind('scrollEnd', proxy(this._scrollEnd, this));\n\n        scroller.userEvents.bind('gesturestart', proxy(this._scaleStart, this));\n        scroller.userEvents.bind('gestureend', proxy(this._scale, this));\n        scroller.userEvents.bind('doubleTap', proxy(this._doubleTap, this));\n        scroller.userEvents.bind('tap', proxy(this._tap, this));\n\n        this.scrollElement = scroller.scrollElement;\n    }\n\n    _initLayers() {\n        let defs = this.options.layers,\n            layers = this.layers = [];\n\n        for (let i = 0; i < defs.length; i++) {\n            let options = defs[i];\n\n            const layer = this._createLayer(options);\n            layers.push(layer);\n        }\n    }\n\n    _createLayer(options) {\n        let type = options.type || 'shape';\n        let layerDefaults = this.options.layerDefaults[type];\n        let layerOptions = type === MARKER ?\n            deepExtend({}, this.options.markerDefaults, options, { icons: this.options.icons }) :\n            deepExtend({}, layerDefaults, options);\n\n        let layerConstructor = layersMap[type];\n        let layer = new layerConstructor(this, layerOptions);\n\n        if (type === MARKER) {\n            this.markers = layer;\n        }\n\n        return layer;\n    }\n\n    _createTooltip() {\n        return new Tooltip(this.widgetService, this.options.tooltip);\n    }\n\n    /* eslint-disable arrow-body-style */\n    _initMarkers() {\n        const markerLayers = (this.options.layers || []).filter(x => {\n            return x && x.type === MARKER;\n        });\n\n        if (markerLayers.length > 0) {\n            // render the markers from options.layers\n            // instead of options.markers\n            return;\n        }\n\n        this.markers = new MarkerLayer(this, deepExtend({}, this.options.markerDefaults, { icons: this.options.icons }));\n        this.markers.add(this.options.markers);\n    }\n    /* eslint-enable arrow-body-style */\n\n    _scroll(e) {\n        let origin = this.locationToLayer(this._viewOrigin).round();\n        let movable = e.sender.movable;\n        let offset = new g.Point(movable.x, movable.y).scale(-1).scale(1 / movable.scale);\n\n        origin.x += offset.x;\n        origin.y += offset.y;\n        this._scrollOffset = offset;\n\n        this._tooltip.offset = offset;\n        this.hideTooltip();\n\n        this._setOrigin(this.layerToLocation(origin));\n\n        this.trigger('pan', {\n            originalEvent: e,\n            origin: this._getOrigin(),\n            center: this.center()\n        });\n    }\n\n    _scrollEnd(e) {\n        if (!this._scrollOffset || !this._panComplete()) {\n            return;\n        }\n\n        this._scrollOffset = null;\n        this._panEndTimestamp = now();\n\n        this.trigger('panEnd', {\n            originalEvent: e,\n            origin: this._getOrigin(),\n            center: this.center()\n        });\n    }\n\n    _panComplete() {\n        return now() - (this._panEndTimestamp || 0) > 50;\n    }\n\n    _scaleStart(e) {\n        if (this.trigger('zoomStart', { originalEvent: e })) {\n            let touch = e.touches[1];\n\n            if (touch) {\n                touch.cancel();\n            }\n        }\n    }\n\n    _scale(e) {\n        let scale = this.scroller.movable.scale;\n        let zoom = this._scaleToZoom(scale);\n        let gestureCenter = new g.Point(e.center.x, e.center.y);\n        let centerLocation = this.viewToLocation(gestureCenter, zoom);\n        let centerPoint = this.locationToLayer(centerLocation, zoom);\n        let originPoint = centerPoint.translate(-gestureCenter.x, -gestureCenter.y);\n\n        this._zoomAround(originPoint, zoom);\n\n        this.trigger('zoomEnd', {\n            originalEvent: e\n        });\n    }\n\n    _scaleToZoom(scaleDelta) {\n        let scale = this._layerSize() * scaleDelta;\n        let tiles = scale / this.options.minSize;\n        let zoom = math.log(tiles) / math.log(2);\n\n        return math.round(zoom);\n    }\n\n    _reset() {\n        if (this.attribution) {\n            this.attribution.filter(this.center(), this.zoom());\n        }\n\n        this._viewOrigin = this._getOrigin(true);\n\n        this._resetScroller();\n        this.hideTooltip();\n\n        this.trigger('beforeReset');\n        this.trigger('reset');\n    }\n\n    _resetScroller() {\n        let scroller = this.scroller;\n        let x = scroller.dimensions.x;\n        let y = scroller.dimensions.y;\n        let scale = this._layerSize();\n        let nw = this.extent().nw;\n        let topLeft = this.locationToLayer(nw).round();\n\n        scroller.movable.round = true;\n        scroller.reset();\n        scroller.userEvents.cancel();\n\n        let zoom = this.zoom();\n\n        scroller.dimensions.forcedMinScale = pow(2, this.options.minZoom - zoom);\n        scroller.dimensions.maxScale = pow(2, this.options.maxZoom - zoom);\n\n        let xBounds = {\n            min: -topLeft.x,\n            max: scale - topLeft.x\n        };\n\n        let yBounds = {\n            min: -topLeft.y,\n            max: scale - topLeft.y\n        };\n\n        if (this.options.wraparound) {\n            xBounds.max = 20 * scale;\n            xBounds.min = -xBounds.max;\n        }\n\n        if (this.options.pannable === false) {\n            let viewSize = this.viewSize();\n            xBounds.min = yBounds.min = 0;\n            xBounds.max = viewSize.width;\n            yBounds.max = viewSize.height;\n        }\n\n        x.makeVirtual();\n        y.makeVirtual();\n\n        x.virtualSize(xBounds.min, xBounds.max);\n        y.virtualSize(yBounds.min, yBounds.max);\n\n        this._virtualSize = {\n            x: xBounds,\n            y: yBounds\n        };\n    }\n\n    // kept for API compatibility, not used\n    _renderLayers() {\n    }\n\n    _layerSize(zoom) {\n        const newZoom = valueOrDefault(zoom, this.options.zoom);\n        return this.options.minSize * pow(2, newZoom);\n    }\n\n    _tap(e) {\n        if (!this._panComplete()) {\n            return;\n        }\n\n        let cursor = this.eventOffset(e);\n        this.hideTooltip();\n\n        this.trigger('click', {\n            originalEvent: e,\n            location: this.viewToLocation(cursor)\n        });\n    }\n\n    _doubleTap(e) {\n        let options = this.options;\n\n        if (options.zoomable !== false) {\n            if (!this.trigger('zoomStart', { originalEvent: e })) {\n                let toZoom = this.zoom() + DEFAULT_ZOOM_RATE;\n                let cursor = this.eventOffset(e);\n                let location = this.viewToLocation(cursor);\n                let postZoom = this.locationToLayer(location, toZoom);\n                let origin = postZoom.translate(-cursor.x, -cursor.y);\n\n                this._zoomAround(origin, toZoom);\n\n                this.trigger('zoomEnd', {\n                    originalEvent: e\n                });\n            }\n        }\n    }\n\n    _mousewheel(e) {\n        let delta = mousewheelDelta(e) > 0 ? -1 : 1;\n        let options = this.options;\n        let fromZoom = this.zoom();\n        let toZoom = limitValue(fromZoom + delta, options.minZoom, options.maxZoom);\n\n        if (options.zoomable !== false && toZoom !== fromZoom) {\n            if (!this.trigger('zoomStart', { originalEvent: e })) {\n                let cursor = this.eventOffset(e);\n                let location = this.viewToLocation(cursor);\n                let postZoom = this.locationToLayer(location, toZoom);\n                let origin = postZoom.translate(-cursor.x, -cursor.y);\n\n                this._zoomAround(origin, toZoom);\n\n                this.trigger('zoomEnd', {\n                    originalEvent: e\n                });\n            }\n        }\n    }\n\n    _toDocumentCoordinates(point) {\n        const offset = elementOffset(this.element);\n\n        return {\n            left: round(point.x + offset.left),\n            top: round(point.y + offset.top)\n        };\n    }\n}\n\nsetDefaultOptions(Map, {\n    name: 'Map',\n    controls: {\n        attribution: true,\n        navigator: {\n            panStep: 100\n        },\n        zoom: true\n    },\n    layers: [],\n    layerDefaults: {\n        shape: {\n            style: {\n                fill: {\n                    color: '#fff'\n                },\n                stroke: {\n                    color: '#aaa',\n                    width: 0.5\n                }\n            }\n        },\n        bubble: {\n            style: {\n                fill: {\n                    color: '#fff',\n                    opacity: 0.5\n                },\n                stroke: {\n                    color: '#aaa',\n                    width: 0.5\n                }\n            }\n        },\n        marker: {\n            shape: 'pinTarget',\n            tooltip: {\n                position: 'top'\n            }\n        }\n    },\n    center: [\n        0,\n        0\n    ],\n    icons: {\n        type: \"font\",\n        svgIcons: {}\n    },\n    zoom: 3,\n    minSize: 256,\n    minZoom: 1,\n    maxZoom: 19,\n    markers: [],\n    markerDefaults: {\n        shape: 'pinTarget',\n        tooltip: {\n            position: 'top'\n        }\n    },\n    wraparound: true,\n    // If set to true, GeoJSON layer \"Point\" features will be rendered as markers.\n    // Otherwise, the points will be rendered as circles.\n    // Defaults to `true` for KUI/jQuery, `false` everywhere else.\n    renderPointsAsMarkers: false\n});\n\nsetDefaultEvents(Map, [\n    'beforeReset',\n    'click',\n    'markerActivate',\n    'markerClick',\n    'markerCreated',\n\n    // Events for implementing custom tooltips.\n    'markerMouseEnter',\n    'markerMouseLeave',\n\n    'pan',\n    'panEnd',\n    'reset',\n    'shapeClick',\n    'shapeCreated',\n    'shapeFeatureCreated',\n    'shapeMouseEnter',\n    'shapeMouseLeave',\n    'zoomEnd',\n    'zoomStart'\n]);\n\nexport default Map;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}